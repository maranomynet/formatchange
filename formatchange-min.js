/* FormatChange  -- (c) 2012-2016 Hugsmi√∞jan ehf.   @license MIT/GPL */
!function(){"use strict";var e=window,n=!!e.addEventListener,t=Object.create||function(e){var n=function(){};return n.prototype=e,new n},a=function(e,n){var r=this;return this instanceof a?(n=n||{},r.win=n.win||r.win,r.elm=n.elm,n.elmTagName&&(r.elmTagName=n.elmTagName),n.elmId&&(r.elmId=n.elmId),"manual"in n&&(r.manual=n.manual),"defer"in n&&(r.defer=n.defer),r.formatGroups=e||t(r.formatGroups),r.media={},r._callbacks=[],r._check=function(){r.check()},!r.defer&&r.start(),void 0):new a(e,n)};a.prototype={elmTagName:"del",elmId:"mediaformat",manual:!1,defer:!1,win:e,formatGroups:{},isRunning:function(){return this._on},start:function(e){var t=this;if(!t._on){var a=t.win;if(!t.elm){var r=a.document,i=t.elmId||"mediaformat",o=t.elm=r.getElementById(i);if(!o){o=t.elm=r.createElement(t.elmTagName||"del");var l=o.style;l.position="absolute",l.visibility=l.overflow="hidden",l.border=l.padding=l.margin=l.width=l.height=0,o.id=i,o._isMine=!0,r.body.appendChild(o)}}t._on=!0,t.manual||(n?a.addEventListener("resize",t._check):a.attachEvent("onresize",t._check)),t.refresh(e)}},stop:function(){var e=this,t=e.elm;e._on&&(e.manual||(n?e.win.removeEventListener("resize",e._check):e.win.detachEvent("onresize",e._check)),t._isMine&&(t.parentNode.removeChild(t),delete e.elm),e._on=!1)},refresh:function(e){var n=this;return e&&(n.oldFormat=null),n._on&&(n.check()||n._updateFlags()),n._on},subscribe:function(e){var n=this;e&&(n.unsubscribe(e),n._callbacks.push(e),n._on&&!n._triggering&&e(n.media))},unsubscribe:function(e){for(var n,t=this._callbacks,a=0;n=t[a];a++)if(n===e){t.splice(a,1);break}},_on:!1,_updateFlags:function(){var e=this,n=e.media,t=e.formatGroups;for(var a in t){var r=t[a],i=!(!r||!r[n.is]),o=!(!r||!r[n.was]);n["is"+a]=i,n["was"+a]=o,n["became"+a]=i&&!o,n["left"+a]=!i&&o,!r&&delete t[a]}},check:function(){var e=this;if(e._on){var n=e.media,t=e.oldFormat,a=e.elm,r=e.win.getComputedStyle,i=r&&r(a,":after").getPropertyValue("content");i&&"none"!==i||(i=(r?r(a,null).getPropertyValue("font-family"):a.currentStyle.fontFamily)||""),i=i.replace(/['"]/g,"");var o=i!==t;if(o){n.is=n.format=i,n.was=n.lastFormat=t,e.oldFormat=i,e._updateFlags(),e._triggering=!0;for(var l,m=0;l=e._callbacks[m];m++)l(n);e._triggering=!1}return o}}},a.jQueryPlugin=function(n,t){n.formatChange=function(r,i){i=i||{};var o=i.win||a.prototype.win||e,l="$formatchange_jquery_instances",m=o[l];m||(m=o[l]={});var s=i.eventName||t||"formatchange",c=m[s];if(!c){c=m[s]=new a(r,i);var u="_$triggered";c.subscribe(function(e){n(o).trigger(s,[e])}),n.event.special[s]={add:function(e){setTimeout(function(){var t=e.handler;c._on&&!t[u]&&t.call(o,n.Event(s),c.media)},0)},handle:function(e){var n=e.handleObj.handler;return n[u]=!0,n.apply(this,arguments)}}}return c}},"object"==typeof module&&"object"==typeof module.exports?module.exports=a:e.FormatChange=a;var r=e.jQuery;r&&!r.formatChange&&a.jQueryPlugin(r)}();

